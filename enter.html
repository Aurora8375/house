<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>登录</title>
    <link rel="stylesheet" href="./css/public.css">
    <script src="./js/setRem.js"></script>
    <link rel="stylesheet" href="./css/register.css">
</head>

<body>

    <div class="box">
        <!--头部-->
        <header>
            <h1><a href="#"><img src="image/index/logo.jpg" alt="" /></a></h1>

            <div class="icon">
                <a href="#"><img src="image/index/my.jpg" alt="" /></a>
                <a href="#"><img src="image/index/xiazai.jpg" alt="" /></a>
            </div>
        </header>

        <main>
            <section class="title">
                <p><strong>首页</strong> > <span>我的</span> > <span>登录</span></p>
            </section>
            <nav>
                <div class="red">普通登录</div>
                <div>验证码快捷登录</div>
            </nav>
            <section class="register common">
                <form action="#">
                    <ul>
                        <li><input type="text" placeholder="请输入短信中的验证码" class="phone1" /></li>
                        <li><input type="password" placeholder="请输入密码" class="psd1" /></li>
                    </ul>
                    <button class="registerBtn immediately">立即登录</button>
                </form>
            </section>
            <section class="register verification">
                <form action="#">
                    <ul>
                        <li class="mima">
                            <input type="text" placeholder="请输入手机号码" class="phone2" />
                            <a href="#" class="verify">发送验证码</a>
                        </li>
                        <li><input type="text" placeholder="请输入短信中的验证码" class="yzm" /></li>
                    </ul>
                    <button class="registerBtn login">验证并登录</button>
                </form>
            </section>
            <section>
                <a href="./register.html">立即注册</a>
                <a href="./findPassword.html">忘记密码</a>
            </section>
        </main>





    </div>

</body>

</html>
<script src="./js/touch-0.2.14.min.js"></script>
<script>
    var enter_ = document.getElementsByTagName('nav')[0].children;
    var common = document.getElementsByClassName('common')[0];
    var verification = document.getElementsByClassName('verification')[0];
    var phone1 = document.getElementsByClassName('phone1')[0];
    var phone2 = document.getElementsByClassName('phone2')[0];
    var psd1 = document.getElementsByClassName('psd1')[0];
    var yzm = document.getElementsByClassName('yzm')[0];
    var immediately = document.getElementsByClassName('immediately')[0];
    var login = document.getElementsByClassName('login')[0];
    var num = 60;
    var verify = document.getElementsByClassName('verify')[0];
    var html_ = document.getElementsByTagName('html')[0];
    function getCookie(key) {
        var array = document.cookie.split("; ")
        for (var item of array) {
            var newArray = item.split("=")
            if (newArray[0] == key) {
                return newArray[1];
            }
        }
    }
    phone1.value = getCookie('user')
    phone2.value = getCookie('user')
    psd1.value = getCookie('psd')
    touch.on(enter_[0], 'tap', function () {
        for (var j = 0; j < enter_.length; j++) {
            enter_[j].className = ''
        }
        common.style.display = 'block'
        verification.style.display = 'none'
        this.className = 'red'
    })
    touch.on(enter_[1], 'tap', function () {
        for (var j = 0; j < enter_.length; j++) {
            enter_[j].className = ''
        }
        common.style.display = 'none'
        verification.style.display = 'block'
        this.className = 'red'
    })
    touch.on(immediately, 'tap', function () {
        if (phone1.value != getCookie('user')) {
            alert('手机号错误')
        } else if (psd1.value != getCookie('psd')) {
            alert('密码错误')
        } else {
            alert('登录成功')
            window.location.href = './index.html'
        }
    })
    touch.on(login, 'tap', function () {

    })
    touch.on(verify, 'tap', function () {
        var num1 = Math.floor(Math.random() * 10000)
        if (num1 < 1000) {
            num1 = 1000
        }
        if (phone2.value == getCookie('user')) {
            alert('验证码为：' + num1)
            clearInterval(time);
            time = setInterval(function () {

                num--;
                verify.innerHTML = '(' + num + '秒)重发';
                if (num <= 0) {
                    verify.innerHTML = '发送验证码'
                    num = 60;
                    clearInterval(time);
                }
            }, 1000)

        } else {
            alert('手机号未注册,请先注册')
            window.location.href = './register.html'
        }
        touch.on(login, 'tap', function () {
            if (phone2.value != getCookie('user')) {
                alert('手机号未注册,请先注册')
            } else if (yzm.value != num1) {
                alert('验证码错误')
            } else {
                alert('登录成功')
                window.location.href = './index.html'
            }

        })
    })

    touch.on(html_, 'swipeleft', function () {
        history.forward()
    })
    touch.on(html_, 'swiperight', function () {
        history.back()
    })
</script>